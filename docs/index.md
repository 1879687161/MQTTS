## A Vector Quantized Approach for Text to Speech Synthesis on Real-World Spontaneous Speech 

 - Recent Text-to-Speech (TTS) systems trained on reading or acted corpora have achieved near human-level naturalness. The diversity of human speech, however, often goes beyond the coverage of these corpora. We believe the ability to handle such diversity is crucial for AI systems to achieve human-level communication. Our work explores the use of more abundant real-world data for building speech synthesizers. We train TTS systems using real-world speech from YouTube and podcasts. We observe the mismatch between training and inference alignments in mel-spectrogram based autoregressive models, leading to unintelligible synthesis, and demonstrate that learned discrete codes within multiple code groups effectively resolves this issue. We introduce our MQTTS system whose architecture is designed for multiple code generation and monotonic alignment, along with the use of a clean silence prompt to improve synthesis quality. We conduct ablation analyses to identify the efficacy of our methods. We show that MQTTS outperforms existing TTS systems in several objective and subjective measures.
 - Accepted to AAAI 2023
 - [Code](https://github.com/b04901014/MQTTS)
 - [Paper](...)

### Quantizer Reconstruction

|Original Speech|HiFi-GAN|Quantizer (1024 codes, 1 codebook)|Quantizer (65536 codes, 1 codebook)|Quantizer (160 codes, 4 codebook)|Quantizer (160 codes, 4 codebook)|
|---------------|--------|----------------------------------|-----------------------------------|---------------------------------|---------------------------------|
|<audio src="samples/quantizer/gt/id10270-5sJomL_D0_g-00001.wav" type="audio/wav" controls preload></audio>|<audio src="samples/quantizer/mels/id10270-5sJomL_D0_g-00001.wav" type="audio/wav" controls preload></audio>|<audio src="samples/quantizer/1024_single_code/id10270-5sJomL_D0_g-00001.wav" type="audio/wav" controls preload></audio>|<audio src="samples/quantizer/65536_single_code/id10270-5sJomL_D0_g-00001.wav" type="audio/wav" controls preload></audio>|<audio src="samples/quantizer/160_4_code/id10270-5sJomL_D0_g-00001.wav" type="audio/wav" controls preload></audio>|<audio src="samples/quantizer/160_8_code/id10270-5sJomL_D0_g-00001.wav" type="audio/wav" controls preload></audio>|
|<audio src="samples/quantizer/gt/id10285-m-uILToQ9ss-00011.wav" type="audio/wav" controls preload></audio>|<audio src="samples/quantizer/mels/id10285-m-uILToQ9ss-00011.wav" type="audio/wav" controls preload></audio>|<audio src="samples/quantizer/1024_single_code/id10285-m-uILToQ9ss-00011.wav" type="audio/wav" controls preload></audio>|<audio src="samples/quantizer/65536_single_code/id10285-m-uILToQ9ss-00011.wav" type="audio/wav" controls preload></audio>|<audio src="samples/quantizer/160_4_code/id10285-m-uILToQ9ss-00011.wav" type="audio/wav" controls preload></audio>|<audio src="samples/quantizer/160_8_code/id10285-m-uILToQ9ss-00011.wav" type="audio/wav" controls preload></audio>|
|<audio src="samples/quantizer/gt/id10292-v6MWr5UAZ94-00002.wav" type="audio/wav" controls preload></audio>|<audio src="samples/quantizer/mels/id10292-v6MWr5UAZ94-00002.wav" type="audio/wav" controls preload></audio>|<audio src="samples/quantizer/1024_single_code/id10292-v6MWr5UAZ94-00002.wav" type="audio/wav" controls preload></audio>|<audio src="samples/quantizer/65536_single_code/id10292-v6MWr5UAZ94-00002.wav" type="audio/wav" controls preload></audio>|<audio src="samples/quantizer/160_4_code/id10292-v6MWr5UAZ94-00002.wav" type="audio/wav" controls preload></audio>|<audio src="samples/quantizer/160_8_code/id10292-v6MWr5UAZ94-00002.wav" type="audio/wav" controls preload></audio>|
|<audio src="samples/quantizer/gt/id10302-2Er-cV85fc4-00020.wav" type="audio/wav" controls preload></audio>|<audio src="samples/quantizer/mels/id10302-2Er-cV85fc4-00020.wav" type="audio/wav" controls preload></audio>|<audio src="samples/quantizer/1024_single_code/id10302-2Er-cV85fc4-00020.wav" type="audio/wav" controls preload></audio>|<audio src="samples/quantizer/65536_single_code/id10302-2Er-cV85fc4-00020.wav" type="audio/wav" controls preload></audio>|<audio src="samples/quantizer/160_4_code/id10302-2Er-cV85fc4-00020.wav" type="audio/wav" controls preload></audio>|<audio src="samples/quantizer/160_8_code/id10302-2Er-cV85fc4-00020.wav" type="audio/wav" controls preload></audio>|
|<audio src="samples/quantizer/gt/id10306-4E-dEOQQsvo-00004.wav" type="audio/wav" controls preload></audio>|<audio src="samples/quantizer/mels/id10306-4E-dEOQQsvo-00004.wav" type="audio/wav" controls preload></audio>|<audio src="samples/quantizer/1024_single_code/id10306-4E-dEOQQsvo-00004.wav" type="audio/wav" controls preload></audio>|<audio src="samples/quantizer/65536_single_code/id10306-4E-dEOQQsvo-00004.wav" type="audio/wav" controls preload></audio>|<audio src="samples/quantizer/160_4_code/id10306-4E-dEOQQsvo-00004.wav" type="audio/wav" controls preload></audio>|<audio src="samples/quantizer/160_8_code/id10306-4E-dEOQQsvo-00004.wav" type="audio/wav" controls preload></audio>|

### Overall TTS Examples

|Reference Speaker|Transformer TTS|VITS (40M)|VITS (100M)|MQTTS (40M)|MQTTS (100M)|MQTTS (200M)|Text                                  |
|-----------------|---------------|----------|-----------|-----------|------------|------------|--------------------------------------|
|<audio src="samples/speaker_reference_audio/id10309.wav" type="audio/wav" controls preload></audio>|<audio src="samples/TransformerTTS/sentence-6-1.wav" type="audio/wav" controls preload></audio>|<audio src="samples/VITS-40M/sentence-6-1.wav" type="audio/wav" controls preload></audio>|<audio src="samples/VITS-100M/sentence-6-1.wav" type="audio/wav" controls preload></audio>|<audio src="samples/VQTTS-40M/sentence-6-1.wav" type="audio/wav" controls preload></audio>|<audio src="samples/VQTTS-100M/sentence-6-1.wav" type="audio/wav" controls preload></audio>|<audio src="samples/VQTTS-200M/sentence-6-1.wav" type="audio/wav" controls preload></audio>|in two thousand and eighteen there was so much um expectation on messi can he take them to the final and win it this time .|
|<audio src="samples/speaker_reference_audio/id10293.wav" type="audio/wav" controls preload></audio>|<audio src="samples/TransformerTTS/sentence-38-1.wav" type="audio/wav" controls preload></audio>|<audio src="samples/VITS-40M/sentence-38-1.wav" type="audio/wav" controls preload></audio>|<audio src="samples/VITS-100M/sentence-38-1.wav" type="audio/wav" controls preload></audio>|<audio src="samples/VQTTS-40M/sentence-38-1.wav" type="audio/wav" controls preload></audio>|<audio src="samples/VQTTS-100M/sentence-38-1.wav" type="audio/wav" controls preload></audio>|<audio src="samples/VQTTS-200M/sentence-38-1.wav" type="audio/wav" controls preload></audio>|maybe don't have enough room in front of the truck to ah get the truck out where you need it to to get you straight .|
|<audio src="samples/speaker_reference_audio/id10290.wav" type="audio/wav" controls preload></audio>|<audio src="samples/TransformerTTS/sentence-37-1.wav" type="audio/wav" controls preload></audio>|<audio src="samples/VITS-40M/sentence-37-1.wav" type="audio/wav" controls preload></audio>|<audio src="samples/VITS-100M/sentence-37-1.wav" type="audio/wav" controls preload></audio>|<audio src="samples/VQTTS-40M/sentence-37-1.wav" type="audio/wav" controls preload></audio>|<audio src="samples/VQTTS-100M/sentence-37-1.wav" type="audio/wav" controls preload></audio>|<audio src="samples/VQTTS-200M/sentence-37-1.wav" type="audio/wav" controls preload></audio>|so same as with an apple watch series two or newer , you can take this ah with you when you're swimming or even snorkeling , yes up to fifty meters .|
|<audio src="samples/speaker_reference_audio/id10281.wav" type="audio/wav" controls preload></audio>|<audio src="samples/TransformerTTS/sentence-35-1.wav" type="audio/wav" controls preload></audio>|<audio src="samples/VITS-40M/sentence-35-1.wav" type="audio/wav" controls preload></audio>|<audio src="samples/VITS-100M/sentence-35-1.wav" type="audio/wav" controls preload></audio>|<audio src="samples/VQTTS-40M/sentence-35-1.wav" type="audio/wav" controls preload></audio>|<audio src="samples/VQTTS-100M/sentence-35-1.wav" type="audio/wav" controls preload></audio>|<audio src="samples/VQTTS-200M/sentence-35-1.wav" type="audio/wav" controls preload></audio>|yeah so ah all of the a i conferences are open to anyone who is capable of ah you know make you know paying for the trip and the the ticket .|
|<audio src="samples/speaker_reference_audio/id10307.wav" type="audio/wav" controls preload></audio>|<audio src="samples/TransformerTTS/sentence-25-1.wav" type="audio/wav" controls preload></audio>|<audio src="samples/VITS-40M/sentence-25-1.wav" type="audio/wav" controls preload></audio>|<audio src="samples/VITS-100M/sentence-25-1.wav" type="audio/wav" controls preload></audio>|<audio src="samples/VQTTS-40M/sentence-25-1.wav" type="audio/wav" controls preload></audio>|<audio src="samples/VQTTS-100M/sentence-25-1.wav" type="audio/wav" controls preload></audio>|<audio src="samples/VQTTS-200M/sentence-25-1.wav" type="audio/wav" controls preload></audio>|but one that stands out to me was , ah , concluding the , ah , montreal protocol , ah , as a treaty that dealt with a extraordinarily significant environmental issue .|
|<audio src="samples/speaker_reference_audio/id10285.wav" type="audio/wav" controls preload></audio>|<audio src="samples/TransformerTTS/sentence-36-1.wav" type="audio/wav" controls preload></audio>|<audio src="samples/VITS-40M/sentence-36-1.wav" type="audio/wav" controls preload></audio>|<audio src="samples/VITS-100M/sentence-36-1.wav" type="audio/wav" controls preload></audio>|<audio src="samples/VQTTS-40M/sentence-36-1.wav" type="audio/wav" controls preload></audio>|<audio src="samples/VQTTS-100M/sentence-36-1.wav" type="audio/wav" controls preload></audio>|<audio src="samples/VQTTS-200M/sentence-36-1.wav" type="audio/wav" controls preload></audio>|my guitar we just wanted to give a very timeless feeling with this ah album cover when i'm in my real life i'm basically always very unsophisticated .|
|<audio src="samples/speaker_reference_audio/id10295.wav" type="audio/wav" controls preload></audio>|<audio src="samples/TransformerTTS/sentence-22-1.wav" type="audio/wav" controls preload></audio>|<audio src="samples/VITS-40M/sentence-22-1.wav" type="audio/wav" controls preload></audio>|<audio src="samples/VITS-100M/sentence-22-1.wav" type="audio/wav" controls preload></audio>|<audio src="samples/VQTTS-40M/sentence-22-1.wav" type="audio/wav" controls preload></audio>|<audio src="samples/VQTTS-100M/sentence-22-1.wav" type="audio/wav" controls preload></audio>|<audio src="samples/VQTTS-200M/sentence-22-1.wav" type="audio/wav" controls preload></audio>|i think it was very well planned very well executed and ah to solve those big bombs in this closed circle around and on the ship .|

### Extra (TODO, will add soon)
 - Mandarin
 - Out-of-domain speakers

### Observations
 - TODO
